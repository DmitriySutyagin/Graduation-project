# **Глава 3 . ТЕСТИРОВАНИЕ МОДЕЛИ НЕЙРОННОЙ СЕТИ**   
В ходе выполнения итоговой аттестационной работы была спроектирована, разработана и протестирована система распознавания сигментированных изображений опухолей молочной железы.  
Данная система выполняет следующие действия:   
*	Создает модель глубокой нейронной сети.
*	Обучает модель глубокой нейронной сети.
* Получает сегментированные изображения и преобразует их в оттенки серого.
*	Бинаризирует изображения преобразуя их в черно-белое.
*	Изменяет изображение в квадратные изображения размером 28х28 пикселе.
*	Оправляет на вход нейронной сети измененные изображения снимков томографии.
*	Получает данные о принадлежности изображения к определенному классу.
*	Выводит на экран предварительный диагноз опухоли молочной железы.
Создание и обучение нейронной сети не требует действий пользователя, так как все параметры изначально записаны в коде.  
Единственным действием, которое должен совершить пользователь, является загрузка фотографии в систему. Это действие выполняется перемещением изображения в папку,
указанную в коде и изменением   названия изображения, чтобы путь в коде совпадал с путем исходного изображения.  
Остальные действия выполнит система и пользователь увидит результат.  
Для проверки работоспособности программы сделаем прогноз на тестовый данных и замерим производительность модели (см. рисунок 3.1, рисунок 3.2)
![Screenshot](../main/Screenshot/рогноз%20на%20тесте.png)
Рисунок 3.1 – Прогноз на тестовых данных
![Screenshot](../main/Screenshot/производительность%20модели.png)
Рисунок 3.2 – Производительность модели  
По результатам замера производительности модели видно, что метрика близка к 1.
Это показывает отличное разделение классов. Важные свойства AUC – это, инвариантность к порогу классификации и масштабу предсказаний.
Инвариантность к масштабу предсказаний означает, что AUC не зависит от масштаба вероятностей, которые генерирует модель.
Важные свойства AUC – это, инвариантность к порогу классификации и масштабу предсказаний. Инвариантность к масштабу предсказаний означает, что AUC не зависит от масштаба вероятностей,
 которые генерирует модель.  
Далее для визуализации предсказаний модели создадим новые пустые массивы, загрузим новые данные, которые модель еще не видела,
обработаем их и итеративно предскажем предварительный диагноз по снимку томографии (см. рисунок 3.3 - 3.8).
![Screenshot](../main/Screenshot/пустые%20массивы%202.png)
Рисунок 3.3 – Пустые массивы для новых данных
![Screenshot](../main/Screenshot/загрузка%20и%20обработка%20изображкений.png)   
Рисунок 3.4 – Загрузка новых данных
![Screenshot](../main/Screenshot/Предсказание%20на%20новых%20данных.png)
Рисунок 3.5 - Обработка иображений  
![Screenshot](../main/Screenshot/обработка%20изображений.png)  
Рисунок 3.6 – Предсказания на новых данных  
![Screenshot](../main/Screenshot/создание%20датафрейма.png)  
Рисунок 3.7 - Создание датафрейма  
![Screenshot](../main/Screenshot/визуалиция%20предказаний.png)  
Рисунок 3.8 – Первые 20 предсказаний модели  
Для определения предварительно диагноза одного пациент достаточно указать порядковый номер изображения, в загрузочной папке и программа предскажет предварительный диагноз (см. рисунок 3.9).
![Screenshot](../main/Screenshot/Предказание%20диагноза%20по%20id.png)
Рисунок 3.9 – Выборочное предсказание  
В данной главе было рассмотрено тестирование обученной модели на данных, которые модель еще не видела.
 Данная модель при обучение показала результат 98,62% правильности предсказания на валидационной выборке и подтвердила его же при проверки производительности модели (см. рисунок 3.2).
Так же было произведено тестирование на дополнительных данных, которые модель еще не видела и был создан датафрейм с результатами тестирования и исходными диагнозами опухолей молочной железы.
А также был добавлен алгоритм для выборочного тестирования пациентов.

